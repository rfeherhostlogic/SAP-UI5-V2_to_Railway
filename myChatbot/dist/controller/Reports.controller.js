sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/Panel","sap/m/Table","sap/m/Column","sap/m/Text","sap/m/ColumnListItem","sap/ui/model/json/JSONModel"],function(e,r,t,a,n,o,s){"use strict";return e.extend("sap.suite.ui.commons.demo.tutorial.controller.Reports",{onInit:function(){var e=this.getView().getModel("reports");if(!e){e=new s({busy:false,error:"",tables:[]});this.getView().setModel(e,"reports")}this._loadDbPreview()},onRefreshPreview:function(){this._loadDbPreview()},_loadDbPreview:function(){var e=this.getView().getModel("reports");e.setProperty("/busy",true);e.setProperty("/error","");fetch("/api/reports/db-preview?maxRows=10",{method:"GET"}).then(function(e){if(!e.ok){return e.text().then(function(e){throw new Error(e||"DB preview hiba")})}return e.json()}).then(function(r){var t=Array.isArray(r&&r.tables)?r.tables:[];e.setProperty("/tables",t);this._renderDbTables(t)}.bind(this)).catch(function(r){e.setProperty("/error",r&&r.message?r.message:"DB preview hiba.")}).finally(function(){e.setProperty("/busy",false)})},_renderDbTables:function(e){var i=this.byId("dbPreviewHost");if(!i){return}i.removeAllItems();(e||[]).forEach(function(e){var l=String(e&&e.tableName?e.tableName:"Ismeretlen tÃ¡bla");var u=Array.isArray(e&&e.columns)?e.columns:[];var d=Array.isArray(e&&e.rows)?e.rows:[];var m=new r({headerText:l+" (max 10 sor)",expandable:true,expanded:false}).addStyleClass("sapUiSmallMarginBottom");var p=new t({inset:false,growing:true,growingThreshold:10});u.forEach(function(e){p.addColumn(new a({header:new n({text:e})}))});if(u.length>0){var w=u.map(function(e){return new n({text:"{row>"+e+"}",wrapping:true})});var f=new o({cells:w});p.setModel(new s({rows:d}),"row");p.bindItems({path:"row>/rows",template:f,templateShareable:false})}m.addContent(p);i.addItem(m)})}})});
//# sourceMappingURL=Reports.controller.js.map