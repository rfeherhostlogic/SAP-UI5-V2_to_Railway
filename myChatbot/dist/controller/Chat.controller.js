sap.ui.define(["sap/ui/core/mvc/Controller"],function(e){"use strict";return e.extend("sap.suite.ui.commons.demo.tutorial.controller.Chat",{onSend:async function(){var e=this.getView().getModel("app");var t=this.getView().getModel("chat");var s=(e.getProperty("/draftMessage")||"").trim();if(!s){return}this._appendMessage("user",s);e.setProperty("/draftMessage","");e.setProperty("/busy",true);try{var a=(t.getProperty("/messages")||[]).map(function(e){return{role:e.role,content:e.content}});var r={message:s,history:a};var n=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!n.ok){var i=await n.text();this._appendMessage("assistant","Hiba a valaszban: "+i);return}var o=await n.json();var c=this._extractReplyText(o);this._appendMessage("assistant",c)}catch(e){this._appendMessage("assistant","Hiba tortent a hivas kozben. Ellenorizd az API endpointot.")}finally{e.setProperty("/busy",false)}},_extractReplyText:function(e){if(!e){return"Ures valasz."}if(typeof e==="string"){return e}if(e.message){return e.message}if(e.answer){return e.answer}if(e.text){return e.text}if(e.choices&&e.choices[0]&&e.choices[0].message&&e.choices[0].message.content){return e.choices[0].message.content}return JSON.stringify(e,null,2)},_appendMessage:function(e,t){var s=this.getView().getModel("chat");var a=s.getProperty("/messages")||[];a.push({role:e,content:t});s.setProperty("/messages",a)}})});
//# sourceMappingURL=Chat.controller.js.map